<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰ visTypes è§†å›¾ç»„ä»¶ï¼ŒVisualize app åº”ç”¨ç»„ä»¶ï¼Œå¦‚timeline hacks, Any module that should be included in every application chromeNavControls, æ›´å¤šâ€¦  é¦–è¦ç›®æ ‡æ˜¯visTypes å…¨å†›å‡ºå‡» git clone kibanaï¼Œåˆ‡æ¢åˆ°ä¸eså¯¹åº”">
<meta property="og:type" content="article">
<meta property="og:title" content="kibana-plugin">
<meta property="og:url" content="https://github.com/xiaoxuez/2017/10/14/kibana-plugin/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰ visTypes è§†å›¾ç»„ä»¶ï¼ŒVisualize app åº”ç”¨ç»„ä»¶ï¼Œå¦‚timeline hacks, Any module that should be included in every application chromeNavControls, æ›´å¤šâ€¦  é¦–è¦ç›®æ ‡æ˜¯visTypes å…¨å†›å‡ºå‡» git clone kibanaï¼Œåˆ‡æ¢åˆ°ä¸eså¯¹åº”">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-08-11T06:51:49.820Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="kibana-plugin">
<meta name="twitter:description" content="Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰ visTypes è§†å›¾ç»„ä»¶ï¼ŒVisualize app åº”ç”¨ç»„ä»¶ï¼Œå¦‚timeline hacks, Any module that should be included in every application chromeNavControls, æ›´å¤šâ€¦  é¦–è¦ç›®æ ‡æ˜¯visTypes å…¨å†›å‡ºå‡» git clone kibanaï¼Œåˆ‡æ¢åˆ°ä¸eså¯¹åº”">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>kibana-plugin</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/categories/">Categories</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/10/14/kibana-plugin-development/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017/10/14/kibana-timeline/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&text=kibana-plugin"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&is_video=false&description=kibana-plugin"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=kibana-plugin&body=Check out this article: https://github.com/xiaoxuez/2017/10/14/kibana-plugin/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&name=kibana-plugin&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’"><span class="toc-number">1.</span> <span class="toc-text">Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰"><span class="toc-number">1.1.</span> <span class="toc-text">Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¦–è¦ç›®æ ‡æ˜¯visTypes"><span class="toc-number">1.1.1.</span> <span class="toc-text">é¦–è¦ç›®æ ‡æ˜¯visTypes</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…¨å†›å‡ºå‡»"><span class="toc-number">1.2.</span> <span class="toc-text">å…¨å†›å‡ºå‡»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#First-Blood"><span class="toc-number">1.3.</span> <span class="toc-text">First Blood</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ç¤ºä¾‹extended-metric"><span class="toc-number">1.3.1.</span> <span class="toc-text">ç¤ºä¾‹extended_metric</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç¤ºä¾‹line-sg"><span class="toc-number">1.3.2.</span> <span class="toc-text">ç¤ºä¾‹line_sg</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#visTypes"><span class="toc-number">1.4.</span> <span class="toc-text">visTypes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ’ä»¶æ ·ä¾‹"><span class="toc-number">1.4.1.</span> <span class="toc-text">æ’ä»¶æ ·ä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æºç æ ·ä¾‹"><span class="toc-number">1.4.2.</span> <span class="toc-text">æºç æ ·ä¾‹</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        kibana-plugin
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Blog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2017-10-14T13:54:55.000Z" itemprop="datePublished">2017-10-14</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/elk/">elk</a>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’"><a href="#Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’" class="headerlink" title="Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’"></a>Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’</h2><h3 id="Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰"><a href="#Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰" class="headerlink" title="Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰"></a>Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰</h3><ul>
<li>visTypes è§†å›¾ç»„ä»¶ï¼ŒVisualize</li>
<li>app åº”ç”¨ç»„ä»¶ï¼Œå¦‚timeline</li>
<li>hacks, Any module that should be included in every application</li>
<li>chromeNavControls,</li>
<li><a href="https://www.elastic.co/guide/en/kibana/current/development-uiexports.html" target="_blank" rel="noopener">æ›´å¤š</a>â€¦</li>
</ul>
<h4 id="é¦–è¦ç›®æ ‡æ˜¯visTypes"><a href="#é¦–è¦ç›®æ ‡æ˜¯visTypes" class="headerlink" title="é¦–è¦ç›®æ ‡æ˜¯visTypes"></a>é¦–è¦ç›®æ ‡æ˜¯visTypes</h4><hr>
<h3 id="å…¨å†›å‡ºå‡»"><a href="#å…¨å†›å‡ºå‡»" class="headerlink" title="å…¨å†›å‡ºå‡»"></a>å…¨å†›å‡ºå‡»</h3><ul>
<li><p>git clone kibanaï¼Œåˆ‡æ¢åˆ°ä¸eså¯¹åº”çš„ç‰ˆæœ¬</p>
</li>
<li><p>npm install,</p>
<ul>
<li>gitåˆ‡æ¢ http</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global url.&quot;https://&quot;.insteadOf &quot;git://&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>chromedriverå¤±è´¥</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm ERR! chromedriver@2.32.3 install: `node install.js`</span><br></pre></td></tr></table></figure>

<p> è§£å†³æ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install chromedriver --chromedriver_cdnurl=https://npm.taobao.org/mirrors/chromedriver</span><br></pre></td></tr></table></figure>

<ul>
<li>é»˜è®¤dev å¯åŠ¨æ–¹å¼ä¼šä½¿ç”¨ssl,æ‰€ä»¥æ˜¯https,å¦‚æœéœ€è¦ä¿®æ”¹çš„è¯ï¼Œå¯ä»¥ä¿®æ”¹\kibana\src\cli\serve\serve.jsæ–‡ä»¶ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">if (opts.dev) &#123;</span><br><span class="line">  set(&apos;env&apos;, &apos;development&apos;);</span><br><span class="line">  set(&apos;optimize.lazy&apos;, true);</span><br><span class="line"></span><br><span class="line">  // if (opts.ssl) &#123;</span><br><span class="line">  //   set(&apos;server.ssl.enabled&apos;, true);</span><br><span class="line">  // &#125;</span><br><span class="line"></span><br><span class="line">  // if (opts.ssl &amp;&amp; !has(&apos;server.ssl.certificate&apos;) &amp;&amp; !has(&apos;server.ssl.key&apos;)) &#123;</span><br><span class="line">  //   set(&apos;server.ssl.certificate&apos;, DEV_SSL_CERT_PATH);</span><br><span class="line">  //   set(&apos;server.ssl.key&apos;, DEV_SSL_KEY_PATH);</span><br><span class="line">  // &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>npm start</p>
</li>
</ul>
<h3 id="First-Blood"><a href="#First-Blood" class="headerlink" title="First Blood"></a>First Blood</h3><p>è‡ªå®šä¹‰visTypesçš„è¯ï¼Œåœ¨kibana/pluginsä¸‹æ–°å»ºæ–‡ä»¶å¤¹ï¼Œåœ¨æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sao kibana-plugin</span><br></pre></td></tr></table></figure>

<p>å¯ç”Ÿæˆå¯¹åº”æ–‡ä»¶å¤¹æ ¼å¼ï¼Œå¦‚æœæ˜¯visTypesçš„è¯ï¼Œapp componentï¼Œtranslation filesï¼Œan hack componentï¼Œ a server APIéƒ½é€‰noå°±å¥½äº†</p>
<ul>
<li>new TemplateVisTypeå‚æ•°è§£æ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">return new TemplateVisType(&#123;</span><br><span class="line">    name: &apos;extended_metric&apos;,</span><br><span class="line">    title: &apos;Extended Metric&apos;,</span><br><span class="line">    description: &apos;Based on the core Metric-Plugin but gives you the ability&apos; +</span><br><span class="line">      &apos;to output custom aggregates on metric-results.&apos;,</span><br><span class="line">    icon: &apos;fa-calculator&apos;,</span><br><span class="line">    template: extendedMetricVisTemplate, //è§†å›¾æ¨¡æ¿</span><br><span class="line">    params: &#123; //Optionsé€‰é¡¹</span><br><span class="line">      defaults: &#123;</span><br><span class="line">        handleNoResults: true,</span><br><span class="line">        fontSize: 60,</span><br><span class="line">        outputs: [</span><br><span class="line">          &#123;</span><br><span class="line">            formula: &apos;metrics[0].value * metrics[0].value&apos;,</span><br><span class="line">            label: &apos;Count squared&apos;,</span><br><span class="line">            enabled: true</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      editor: metricVisParamsTemplate //Optionsè§†å›¾æ¨¡æ¿</span><br><span class="line">    &#125;,</span><br><span class="line">    schemas: new Schemas([ //Dataç›¸å…³</span><br><span class="line">      &#123;</span><br><span class="line">        group: &apos;metrics&apos;,</span><br><span class="line">        name: &apos;metric&apos;,</span><br><span class="line">        title: &apos;Metric&apos;,</span><br><span class="line">        min: 1,</span><br><span class="line">        defaults: [</span><br><span class="line">          &#123; type: &apos;count&apos;, schema: &apos;metric&apos; &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä¾‹å­æ¥æºäº<a href="https://github.com/ommsolutions/kibana_ext_metrics_vis">åœ°å€</a>ï¼Œä¸€ä¸ªvisæ’ä»¶ã€‚</p>
<p>çœ‹ç€AngularJSçš„è¯­æ³•ï¼Œæˆ‘æƒ³é™é™ã€‚</p>
<p>ç›®å‰çœ‹èµ·æ¥ï¼ŒvisåŒ…æ‹¬ä¸»è¦çš„å†…å®¹åŒ…æ‹¬</p>
<ul>
<li>schema, ä¸ºå·¦è¾¹æ Dataéƒ¨åˆ†ï¼Œé€‰æ‹©å·²æœ‰çš„ç»„ä»¶å³å¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œmetric æ•°å€¼èšåˆè‚¯å®šæ˜¯ Y è½´ï¼›bucket èšåˆè‚¯å®šæ˜¯ X è½´ï¼›è€Œåœ¨æ­¤åŸºç¡€ä¸Šï¼ŒKibana4 è¿˜å¯ä»¥è®© bucket æœ‰ä¸åŒæ•ˆæœï¼Œä¹Ÿå°±æ˜¯ Schema é‡Œçš„ segment(é»˜è®¤), group å’Œ splitã€‚æ ¹æ®æ•ˆæœä¸åŒï¼Œè¿™é‡Œæ˜¯å„æœ‰å¢å‡çš„ï¼Œæ¯”å¦‚é¥¼å›¾å°±ä¸ä¼šæœ‰ groupã€‚</li>
<li>Options(params),ä¸ºå·¦è¾¹æ Optionséƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ¸²æŸ“html</li>
<li>æ˜¾ç¤ºå¯è§†åŒ–è§†å›¾html</li>
<li>controller, ä¸ºhtmlçš„é€»è¾‘éƒ¨åˆ†, V &lt;-&gt; Cæ˜¯åŒå‘ç»‘å®šçš„ã€‚</li>
</ul>
<p>å…ˆæ¢³ç†ä¸€ä¸‹éœ€æ±‚ï¼Œæœ€å¥½æ˜¯åœ¨esèšåˆæ•°æ®æ‹¿åˆ°ä¹‹åï¼Œåˆ°viewçš„é‚£å±‚ä¸­é—´å°†æ•°æ®åšä¿®æ”¹ã€‚ç„¶åæˆ‘éœ€è¦æ‰¾åˆ°æ•°æ®å¤„ç†çš„ä»£ç ã€‚æ—¢ç„¶è¿™æ ·ï¼Œå»çœ‹çœ‹åŸå§‹visç»„ä»¶å§ã€‚<a href="https://sunyonggang.gitbooks.io/elkstack-guide-cn/content/kibana/v4/source-code-analysis/visualize_app.html" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<ul>
<li>src/core_plugins/kbn_vislib_vis_typesä¸‹æ–¹æ˜¯å„ç»„ä»¶çš„å®šä¹‰éƒ¨åˆ†</li>
<li>src/ui/public/vislibæ˜¯viså…·ä½“æ¸²æŸ“ï¼Œvisç»„ä»¶çš„controllerå’Œhtmlæ¸²æŸ“ä¸»è¦å°±æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶ä¸‹ï¼Œç„¶è€Œæˆ‘æ²¡æ‰¾åˆ°æ¯”è¾ƒæ˜æ˜¾çš„controller,æ¸²æŸ“ä¸»è¦æ˜¯d3è¿›è¡Œæ¸²æŸ“</li>
</ul>
<p>æ„Ÿè§‰å¾ˆèŒ«ç„¶..</p>
<p>èµ°ä¸ä¸‹å»çš„æ—¶å€™ï¼Œåˆå€’å›æ¥é‡æ–°èµ°ã€‚è§£æä¸€ä¸‹ä¸Šé¢ç²˜çš„ä»£ç ï¼Œé¦–å…ˆæ˜¯TemplateVisTypeã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">export default function TemplateVisTypeFactory(Private) &#123;</span><br><span class="line">  const VisType = Private(VisVisTypeProvider);</span><br><span class="line">  const TemplateRenderbot = Private(TemplateVisTypeTemplateRenderbotProvider);</span><br><span class="line"></span><br><span class="line">	// Â·ã€‚ç¬¬ä¸€ï¼Œç»§æ‰¿VisTypeï¼Œå¢åŠ äº†templateæ£€æµ‹</span><br><span class="line">  _.class(TemplateVisType).inherits(VisType);</span><br><span class="line">  function TemplateVisType(opts = &#123;&#125;) &#123;</span><br><span class="line">    TemplateVisType.Super.call(this, opts);</span><br><span class="line"></span><br><span class="line">    this.template = opts.template;</span><br><span class="line">    if (!this.template) &#123;</span><br><span class="line">      throw new Error(&apos;Missing template for TemplateVisType&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">	// Â·ã€‚ç¬¬äºŒï¼Œå¢åŠ äº†createRenderbotï¼Œä¸‹é¢ä¼šå¯¹æ¯”çœ‹çœ‹ï¼Œé‡å†™çš„æ„ä¹‰</span><br><span class="line">  TemplateVisType.prototype.createRenderbot = function (vis, $el, uiState) &#123;</span><br><span class="line">    return new TemplateRenderbot(vis, $el, uiState);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return TemplateVisType;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ˜¯çœ‹çœ‹VislibVisTypeï¼ŒåŸºæœ¬visç»§æ‰¿çš„æ˜¯è¿™ä¸ªï¼Œè·ŸTemplateVisTypeåº”è¯¥æ˜¯å·®ä¸å¤šçš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">export default function VislibVisTypeFactory(Private) &#123;</span><br><span class="line">	...</span><br><span class="line">	const updateParams = function (params) &#123;</span><br><span class="line">		const updateIfSet = (from, to, prop, func) =&gt; &#123;</span><br><span class="line">	      if (from[prop]) &#123;</span><br><span class="line">	        to[prop] = func ? func(from[prop]) : from[prop];</span><br><span class="line">	      &#125;</span><br><span class="line">	    &#125;;</span><br><span class="line">	    ...</span><br><span class="line">	&#125;)</span><br><span class="line">	...</span><br><span class="line">	// Â·ã€‚ç¬¬ä¸€ï¼Œç»§æ‰¿VisTypeï¼Œçœ‹åˆ°responseConverteré»˜è®¤æ˜¯è½¬æ¢ä¸ºç‚¹çº¿å›¾æ•°ç»„çš„ã€‚</span><br><span class="line">	_.class(VislibVisType).inherits(VisType);</span><br><span class="line">   function VislibVisType(opts = &#123;&#125;) &#123;</span><br><span class="line">     VislibVisType.Super.call(this, opts);</span><br><span class="line"></span><br><span class="line">     if (this.responseConverter == null) &#123;</span><br><span class="line">       this.responseConverter = pointSeries;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     this.listeners = opts.listeners || &#123;&#125;;</span><br><span class="line">   &#125;</span><br><span class="line">	// Â·ã€‚ç¬¬äºŒï¼Œå¢åŠ äº†createRenderbot</span><br><span class="line">	   VislibVisType.prototype.createRenderbot = function (vis, $el, uiState) &#123;</span><br><span class="line">	   // åœ¨è¿”å›æ–°VislibRenderbotå¯¹è±¡ä¹‹å‰ï¼Œå¯¹vis.paramsè¿›è¡Œäº†ç›¸åº”çš„è½¬æ¢å’Œåˆ¤æ–­ï¼Œæ¯”å¦‚æŠŠä¸€äº›paramsä¸‹çš„å±æ€§å¯¹åº”ç§»åˆ°params.seriesParams[0]æˆ–è€…params.valueAxes[0]ï¼Œparams.categoryAxes[0]ä¸‹</span><br><span class="line">	    updateParams(vis.params);</span><br><span class="line">	    return new VislibRenderbot(vis, $el, uiState);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¥½å•¦ï¼Œå†çœ‹çœ‹ä»–ä»¬éƒ½å®ç°çš„VisTypeçš„åºå±±çœŸé¢ç›®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">export default function VisTypeFactory(Private) &#123;</span><br><span class="line">  /**</span><br><span class="line">   * Provides the visualizations for the vislib ğŸ‘ˆå®˜æ–¹æ³¨é‡Šå¾ˆé‡è¦ã€‚å¤§æ¦‚æ„æ€æ˜¯è¾“å…¥å‚æ•°ä¸ºangular module,è¾“å‡ºä¸ºvisçš„class</span><br><span class="line">   *</span><br><span class="line">   * @module vislib</span><br><span class="line">   * @submodule VisTypeFactory</span><br><span class="line">   * @param Private &#123;Object&#125; Loads any function as an angular module</span><br><span class="line">   * @return &#123;Function&#125; Returns an Object of Visualization classes</span><br><span class="line">   */</span><br><span class="line">  return &#123;</span><br><span class="line">    pie: Private(VislibVisualizationsPieChartProvider),</span><br><span class="line">    point_series: Private(VislibVisualizationsPointSeriesProvider)</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¥½ï¼Œå…¶å®ä¸€ç‚¹æ²¡çœ‹åˆ°ï¼Œæ¯”å¦‚ç»§æ‰¿é‚£ä¸ªè¯­æ³•å°±å¾ˆè’™åœˆâ€¦ä¸è¿‡æš‚æ—¶è¿è’™å¸¦çŒœçš„æ€»ç»“ä¸‹å§ã€‚å°±æ˜¯è®²ä¸€ä¸ªangular moduleæåˆ°visçš„classçš„è¿‡ç¨‹ã€‚å…·ä½“æ˜¯æ€ä¹ˆæçš„ï¼Œå¯èƒ½ä¸€ä¼šä¼šçœ‹åˆ°ï¼Œå¯èƒ½ä¸ä¼šã€‚æ¥ä¸‹æ¥çœ‹çœ‹VislibRenderbotçš„ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//å…·ä½“å°±ä¸è´´äº†ï¼Œä¸»è¦å®šä¹‰äº†å‡ ä¸ªç±»ä¼¼ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼Œå¦‚</span><br><span class="line">VislibRenderbot.prototype._createVis</span><br><span class="line">VislibRenderbot.prototype._getVislibParams</span><br><span class="line">VislibRenderbot.prototype.destroy</span><br><span class="line">VislibRenderbot.prototype.updateParams</span><br><span class="line">//çœ‹åˆ°renderæ–¹æ³•äº†ï¼Œè´´ä¸€ä¸‹å…·ä½“çš„ä»£ç ï¼Œçœ‹èµ·æ¥é‡è¦çš„æ˜¯ï¼ŒbuildChartDataæ–¹æ³•å’ŒvislibViså¯¹è±¡</span><br><span class="line">VislibRenderbot.prototype.render = function (esResponse) &#123;</span><br><span class="line">    this.chartData = this.buildChartData(esResponse);</span><br><span class="line">    return AngularPromise.delay(1).then(() =&gt; &#123;</span><br><span class="line">      this.vislibVis.render(this.chartData, this.uiState);</span><br><span class="line">      this.refreshLegend++;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>

<p>å¥½å§..å†å¾€ä¸‹è¿½ï¼Œå¾ˆå¤šå¾ˆå¤š..å°±ä¸æŒ¨ç€è§£é‡Šäº†ï¼Œå¤§æ¦‚è¯´ä¸€ä¸‹ï¼ŒvislibVisç±»ä¸­ä¸»è¦æ˜¯é€‰æ‹©å’Œç»˜åˆ¶å›¾ã€‚åœ¨src/ui/visualizationä¸‹æ˜¯å„ä¸ªç»„ä»¶ç¡®åˆ‡çš„ç»˜å›¾ä»£ç ï¼Œä»–ä»¬éƒ½ç»§æ‰¿è‡ª_chart.js,åœ¨_chart.jsä¸­çœ‹åˆ°renderæ–¹æ³•è°ƒç”¨è‡ªèº«drawæ–¹æ³•ï¼Œæ•…å®ç°_chartçš„ç±»å®ç°drawæ–¹æ³•å³å¯ã€‚å¥½å•¦ï¼Œæºç åˆ†æåœ¨è¿™é‡Œå°±å·®ä¸å¤šäº†ï¼Œå…¶å®è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°è‡ªå·±æƒ³æ‰¾çš„ä¸œè¥¿ã€‚è¿™ä¸ªæ—¶å€™åœ¨githubä¸Šçœ‹åˆ°äº†å¦ä¸€ä¸ªvisçš„æ’ä»¶ã€‚</p>
<p>Visç±»ä¸­æ˜¯æ¸²æŸ“äº†ï¼Œç„¶årenderçš„å‚æ•°ï¼Œdata -&gt; {Object} Elasticsearch query results, è¦æ‰¾dataä»å“ªé‡Œæ¥çš„è¯ï¼Œå°±å¼€å§‹æ‰¾ç±»ä¼¼vis.renderçš„è°ƒç”¨ï¼Œæœäº†ä¸‹ï¼Œè°ƒç”¨ä½ç½®åœ¨VislibRenderbotçš„_createVisæ–¹æ³•ä¸­ï¼Œæ©ï¼Œè¿™å°±è·Ÿä¸€å¼€å§‹è”ç³»èµ·æ¥äº†ï¼Œåˆå›åˆ°äº†VislibRenderbotä¸Šäº†ã€‚ç„¶åç»§ç»­æ‰¾vislibrenderbotå®ä¾‹åŒ–çš„ä½ç½®ï¼Œæ¥åˆ°äº†src/ui/public/visualize/visualize.jsï¼Œçœ‹èµ·æ¥è¿™åƒæ˜¯é«˜åœ°äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$scope.$watch(&apos;esResp&apos;, prereq(function (resp) &#123;</span><br><span class="line">  if (!resp) return;</span><br><span class="line">  $scope.renderbot.render(resp); //esè¯·æ±‚å›æ¥çš„ç»“æœä¼ ç»™äº†renderbot</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<p>å€’å›å»çœ‹çœ‹VislibRenderbotçš„ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VislibRenderbot.prototype.render = function (esResponse) &#123;</span><br><span class="line">  this.chartData = this.buildChartData(esResponse);</span><br><span class="line">  return AngularPromise.delay(1).then(() =&gt; &#123;</span><br><span class="line">    this.vislibVis.render(this.chartData, this.uiState);</span><br><span class="line">    this.refreshLegend++;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¥½! å¥½åƒç¨å¾®æœ‰ç‚¹çœ‰ç›®äº†ã€‚é€šè¿‡renderæ–¹æ³•æŠŠesçš„æ•°æ®ä¼ ç»™äº†renderbotï¼Œrenderboté€šè¿‡buildChartDataè¿›è¡Œæäº‹å®Œäº†å°±æ˜¯æœ€åçš„chartDataäº†ï¼Œä¹Ÿå°±æ˜¯vis.renderä¸­çš„dataäº†ã€‚</p>
<p>æ©! ä»”ç»†ä¸€æƒ³ï¼Œå¥½åƒè¿˜æ˜¯æœ‰ç‚¹ä¹±ï¼Œå†æ‹æ‹ã€‚VislibVisTypeçš„æ–¹æ³•createRenderbotè¿”å›çš„æ˜¯VislibRenderbot,ç„¶åVislibRenderbotçš„æ˜¯è·Ÿvisualizeè¿æ¥çš„æ ¸å¿ƒï¼Œåœ¨visualizeä¸­ï¼ŒVislibRenderbotè¿›è¡Œåˆå§‹åŒ–ï¼Œä¼ å…¥vislibVisçš„htmlå…ƒç´ ï¼Œå’Œesè¿”å›çš„data,ç„¶ååœ¨VislibRenderbotå†…éƒ¨è¿›è¡Œç»˜åˆ¶ã€‚é»˜è®¤çš„VislibRenderbotå†…éƒ¨dataä¼šè¿›è¡ŒbuildChartDataè½¬æ¢ã€‚</p>
<h4 id="ç¤ºä¾‹extended-metric"><a href="#ç¤ºä¾‹extended-metric" class="headerlink" title="ç¤ºä¾‹extended_metric"></a>ç¤ºä¾‹extended_metric</h4><p>ç„¶åå†çœ‹TemplateVisType, è¿™ä¸ªæ˜¯è‡ªå®šä¹‰æ—¶å€™çš„VislibVisTypeï¼Œå¯¹åº”çš„renderbotä¸ºTemplateRenderbot,å®šä¹‰çš„renderä¸ºï¼Œå°±æ˜¯è£¸æ•°æ®ï¼Œåœ¨$scopeä¸­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TemplateRenderbot.prototype.render = function (esResponse) &#123;</span><br><span class="line">  this.$scope.esResponse = esResponse;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æœ€å¼€å§‹æåˆ°äº†extended_metricæ’ä»¶ï¼Œç„¶åä»¥è¿™ä¸ªä¸ºä¾‹ï¼Œçœ‹çœ‹æ•°æ®çš„æµå‘ã€‚åœ¨controllerä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// watches</span><br><span class="line">$scope.$watch(&apos;esResponse&apos;, function (resp) &#123;</span><br><span class="line">  if (resp) &#123;</span><br><span class="line">    calcOutputs.length = 0;</span><br><span class="line">    metrics.length = 0;</span><br><span class="line">    for (let key in metrics) &#123;</span><br><span class="line">      if (metrics.hasOwnProperty(key)) &#123;</span><br><span class="line">        delete metrics[key];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $scope.processTableGroups(tabifyAggResponse($scope.vis, resp));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å•Šè™½ç„¶æ˜¯æ‰¾åˆ°äº†æ•°æ®çš„æ¥æºå’Œæµå‘ï¼Œå¯æ˜¯ï¼Œåˆæ˜¯Angular.. AngularåŸºç¡€ä¸ºé›¶çš„æˆ‘å¿ƒå¥½ç´¯â€¦ä¸è¿‡ä¹Ÿç®—æ˜¯äº†ç„¶äº†ã€‚ç„¶åå…·ä½“çœ‹çœ‹extended_metricæ’ä»¶æ‹¿åˆ°æ•°æ®ä¹‹ååšçš„äº‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$scope.processTableGroups = function (tableGroups) &#123;</span><br><span class="line">  tableGroups.tables.forEach(function (table) &#123;</span><br><span class="line">    table.columns.forEach(function (column, i) &#123;</span><br><span class="line">      const fieldFormatter = table.aggConfig(column).fieldFormatter();</span><br><span class="line">      let value = table.rows[0][i]; //esæ•°æ®å­˜åœ¨table.rowså†…</span><br><span class="line">      let formattedValue = isInvalid(value) ? &apos;?&apos; : fieldFormatter(value);     //æ•°æ®è½¬æ¢åæ‹¿å‡ºlabel, formattedValue</span><br><span class="line">      const metric = &#123;</span><br><span class="line">        label: column.title,</span><br><span class="line">        value: value,</span><br><span class="line">        formattedValue: formattedValue</span><br><span class="line">      &#125;;</span><br><span class="line">      metrics.push(metric);</span><br><span class="line">      metrics[column.title] = metric;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  updateOutputs();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä¸¤æ®µä»£ç æ˜¯ç›¸è¿çš„ï¼Œé¦–å…ˆprocessTableGroupsçš„å‚æ•°æ˜¯tabifyAggResponse($scope.vis, resp)ï¼ŒtabifyAggResponseæ˜¯ä¸€ä¸ªå†…éƒ¨å·²æœ‰çš„æ–¹æ³•ï¼Œä¸»è¦æ˜¯æŠŠesè¿”å›çš„å·²çŸ¥ç»“æ„çš„æ•°æ®ï¼Œè½¬æ¢æˆæ ‡å‡†æ ¼å¼ï¼Œè¿™é‡Œé€‰æ‹©çš„æ˜¯table,å¦‚æœæ˜¯lineçš„è¯ï¼Œå¯ä»¥çœ‹çœ‹point_series.jsã€‚è½¬æ¢åŒ…æ‹¬å‚æ•°åŒ…æ‹¬æ•°æ®ä¹‹å¤–ï¼Œè¿˜æœ‰vis,è½¬æ¢å®Œæˆå¾—åˆ°çš„æ•°æ®ä¸­åŒ…å«esæ•°æ®ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬é€‰é¡¹å¡ä¸­çš„æ•°æ®ï¼Œå¦‚è®¾ç½®çš„labelç­‰ã€‚</p>
<h4 id="ç¤ºä¾‹line-sg"><a href="#ç¤ºä¾‹line-sg" class="headerlink" title="ç¤ºä¾‹line_sg"></a>ç¤ºä¾‹line_sg</h4><p>ç¤ºä¾‹<a href="https://github.com/sbeyn/kibana-plugin-line-sg">åœ°å€</a></p>
<p>ç„¶ååˆ†æä¸€ä¸‹ï¼Œé¡ºä¾¿å·©å›ºä¸€ä¸‹ä¸Šé¢çš„çŸ¥è¯†ã€‚</p>
<p>åœ¨line_sg.jsä¸­ï¼Œç†Ÿæ‚‰çš„æ§ä»¶ï¼ŒTemplateVisTypeï¼ŒåŒ…å«paramså’Œschemasã€‚</p>
<p>åœ¨è§†å›¾line_sg.htmlä¸­,ä½¿ç”¨c3ç»˜åˆ¶ï¼Œåªæœ‰å‡ è¡Œä»£ç ï¼Œçœ‹ä¼¼å¾ˆç®€å•ï¼Œæˆ‘æƒ³æ§åˆ¶ç»˜åˆ¶çš„ä»£ç åº”è¯¥åœ¨controllerä¸­ï¼Œç„¶åçœ‹çœ‹_params.html,æ˜¯Optionçš„é€‰é¡¹å¡ï¼Œä¸»è¦åº”è¯¥æ˜¯è§†å›¾çš„é…ç½®ç›¸å…³ã€‚ç„¶åçœ‹çœ‹controller,åœ¨è§†å›¾controllerä¸­ï¼Œå‰é¢å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯å…³äºè¦ç”»çš„å‡†å¤‡å·¥ä½œï¼Œä»¥æ•°æ®æµå‘ä¸ºæ¥å…¥ç‚¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$scope.$watch(&apos;esResponse&apos;, function (resp) &#123;</span><br><span class="line">    if (resp) &#123;</span><br><span class="line">      console.log(resp);</span><br><span class="line">      metrics.length = 0; //é‡ç½®metricsï¼Œé‡ç½®æ•°ç»„çš„æ–¹å¼æ˜¯ä¿®æ”¹length,emmmå­¦åˆ°äº†</span><br><span class="line">      $scope.processTableGroups(tabifyAggResponse($scope.vis, resp)); //è¿˜æ˜¯ä½¿ç”¨çš„æ•°æ®è¡¨æ ¼å½¢å¼ï¼Œä¸ºä»€ä¹ˆå¤§å®¶éƒ½é€‰è¿™ä¸ªè½¬æ¢å½¢å¼ï¼Ÿæˆ‘çŒœå¯èƒ½æ˜¯å› ä¸ºæ•°æ®æ¯”è¾ƒå¥½æ‹¿å‡ºæ¥..æ•°æ®è¿˜æ˜¯é›†ä¸­çš„ï¼Œæ•°æ®æ‹¿å‡ºæ¥ææˆè‡ªå·±æ ¼å¼çš„ï¼Œä¸è§†å›¾ç›¸å…³çš„æ•°æ®éƒ½åœ¨metricsä¸­ï¼Œ</span><br><span class="line">      $scope.showGraph(); //ä»metricsä¸­æ‹¿å‡ºæ•°æ®ï¼Œåšå›¾</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ˜¯ç¤ºä¾‹æ˜¯ä½¿ç”¨c3æ¥å®Œæˆç»˜åˆ¶çš„ç¤ºä¾‹ï¼Œå› ä¸ºå’Œéœ€æ±‚çš„æ–¹æ³¢åˆšå¥½å¯ä»¥å»åˆï¼Œå°±å…·ä½“ç»†èŠ‚å­¦ä¹ ä¸‹å§ã€‚é¦–å…ˆå°†ä»£ç æ‹·å…¥pluginsæ–‡ä»¶å¤¹ï¼Œå¯åŠ¨kibana,æŸ¥çœ‹æ•ˆæœã€‚å‘ç°ä¸æ€ä¹ˆå¥½çœ‹ï¼Œå¦å¤–é€‰æ‹©chart_types=stepä¼¼ä¹ä¸å·¥ä½œï¼Œçœ‹çœ‹ä»£ç å§ã€‚</p>
<p>é¦–å…ˆå°è¯•æ˜¯ï¼Œè®¾ç½®paramsä¹‹åï¼Œç‚¹å‡»é‡ç»˜ï¼Œæ²¡æœ‰æ•ˆæœã€‚</p>
<p>ä»”ç»†çœ‹äº†çœ‹æ’ä»¶çš„ç»˜åˆ¶å’Œc3çš„ä½¿ç”¨ï¼Œçœ‹äº†çœ‹çº¿ä¸Šçš„kibanaï¼Œå‘ç°lineæ˜¯çœŸçš„å¯ä»¥æœ‰step..è€Œä¸”å›¾å½¢æ²¡æœ‰é”™â€¦å…¶å®æœ¬æ¥lineç”»å›¾å°±æœ‰æ–¹æ³¢ã€‚å¥½å§ï¼Œè¿˜æ˜¯å…ˆçœ‹çœ‹è¿™ä¸ªæ’ä»¶ä¸ºä»€ä¹ˆè®¾ç½®paramsä¹‹åï¼Œç‚¹å‡»é‡ç»˜ï¼Œæ²¡æœ‰è§¦å‘é‡ç»˜å§ã€‚ç»“è®ºæ˜¯æ²¡æœ‰ç›‘å¬å˜é‡çš„å˜åŒ–..$scope.$watchã€$watchControllerç­‰ç›‘å¬æ–¹æ³•ï¼Œè™½ç„¶æ²¡æœ‰çœ‹åˆ°å…·ä½“ä»£ç ï¼Œå¤§æ¦‚æ˜¯ï¼Œä¾§è¾¹æ éƒ¨åˆ†æ²¡æœ‰ä¿®æ”¹çš„è¯ï¼Œé‚£ä¸ªé‡ç»˜çš„æŒ‰é’®å°±æ— æ³•ç‚¹å‡»ï¼Œé‚£ä¸ªæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶åº”è¯¥æ˜¯è§¦å‘watchçš„ç›‘å¬äº‹ä»¶çš„ï¼Œæœ‰ä¿®æ”¹ï¼Œå°±ä¼šè§¦å‘ç›‘å¬äº‹ä»¶ï¼Œè¦é‡ç»˜çš„è¯å…¶å®å°±æ˜¯åœ¨ç›‘å¬äº‹ä»¶çš„å›è°ƒä¸­åŠ å…¥è§†å›¾é‡ç»˜çš„éƒ¨åˆ†ï¼Œå…¶å®æ•°æ®ä¼šè‡ªåŠ¨ç»‘å®šï¼Œåªæ˜¯éœ€è¦ä¸ªåˆ·æ–°æœºåˆ¶ã€‚</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">                                                 /===-_---~~~~~~~~~------____</span><br><span class="line">                                                |===-~___                _,-&apos;</span><br><span class="line">                 -==\\                         `//~\\   ~~~~`---.___.-~~</span><br><span class="line">             ______-==|                         | |  \\           _-~`</span><br><span class="line">       __--~~~  ,-/-==\\                        | |   `\        ,&apos;</span><br><span class="line">    _-~       /&apos;    |  \\                      / /      \      /</span><br><span class="line">  .&apos;        /       |   \\                   /&apos; /        \   /&apos;</span><br><span class="line"> /  ____  /         |    \`\.__/-~~ ~ \ _ _/&apos;  /          \/&apos;</span><br><span class="line">/-&apos;~    ~~~~~---__  |     ~-/~         ( )   /&apos;        _--~`</span><br><span class="line">                  \_|      /        _)   ;  ),   __--~~</span><br><span class="line">                    &apos;~~--_/      _-~/-  / \   &apos;-~ \</span><br><span class="line">                   &#123;\__--_/&#125;    / \\_&gt;- )&lt;__\      \</span><br><span class="line">                   /&apos;   (_/  _-~  | |__&gt;--&lt;__|      |</span><br><span class="line">                  |0  0 _/) )-~     | |__&gt;--&lt;__|      |</span><br><span class="line">                  / /~ ,_/       / /__&gt;---&lt;__/      |</span><br><span class="line">                 o o _//        /-~_&gt;---&lt;__-~      /</span><br><span class="line">                 (^(~          /~_&gt;---&lt;__-      _-~</span><br><span class="line">                ,/|           /__&gt;--&lt;__/     _-~</span><br><span class="line">             ,//(&apos;(          |__&gt;--&lt;__|     /                  .----_</span><br><span class="line">            ( ( &apos;))          |__&gt;--&lt;__|    |                 /&apos; _---_~\</span><br><span class="line">         `-)) )) (           |__&gt;--&lt;__|    |               /&apos;  /     ~\`\</span><br><span class="line">        ,/,&apos;//( (             \__&gt;--&lt;__\    \            /&apos;  //        ||</span><br><span class="line">      ,( ( ((, ))              ~-__&gt;--&lt;_~-_  ~--____---~&apos; _/&apos;/        /&apos;</span><br><span class="line">    `~/  )` ) ,/|                 ~-_~&gt;--&lt;_/-__       __-~ _/</span><br><span class="line">  ._-~//( )/ )) `                    ~~-&apos;_/_/ /~~~~~~~__--~</span><br><span class="line">   ;&apos;( &apos;)/ ,)(                              ~~~~~~~~~~</span><br><span class="line">  &apos; &apos;) &apos;( (/</span><br><span class="line">    &apos;   &apos;  `</span><br></pre></td></tr></table></figure>

<hr>
<p>åé¢æ•´ç†äº†ä¸‹ï¼Œæ€è·¯ç¨å¾®æ¸…æ™°ä¸€ç‚¹çš„ã€‚</p>
<p>å¼€å‘æ’ä»¶çš„è¯ï¼Œéƒ½éœ€è¦ä¸€å®šçš„æ¨¡æ¿ï¼Œå®˜æ–¹æ¨èçš„ç”Ÿæˆæ¨¡æ¿çš„è„šæ‰‹æ¶<a href="https://github.com/saojs/sao">sao</a>,å…·ä½“ä½¿ç”¨<a href="https://github.com/elastic/template-kibana-plugin">æ ·ä¾‹</a>ã€‚è¿˜æœ‰æ’ä»¶å¼€å‘çš„<a href="https://www.gitbook.com/book/trumandu/kibana-plugin-development-tutorial/details" target="_blank" rel="noopener">æ•™ç¨‹</a>ã€‚ç¯‡å¹…åŸå› ï¼Œå°±çœå»æ•™ç¨‹ç³»åˆ—ï¼Œä¸»è¦çœ‹çœ‹ç»“æ„ï¼Œæºç ä»€ä¹ˆçš„..</p>
<h3 id="visTypes"><a href="#visTypes" class="headerlink" title="visTypes"></a>visTypes</h3><p>Visualizeæ’ä»¶çš„å¼€å‘ï¼Œç»„æˆä¸»è¦æ˜¯es6,angular(å¬è¯´angular1å’Œ2å®Œå…¨æ²¡å…³ç³»ï¼Œç‰¹åœ°æŒ‡å‡ºkibanaé‡‡ç”¨çš„æ˜¯angular1)ã€‚kibanaçš„Visualizeç»„ä»¶çš„ç»˜åˆ¶ä¸»è¦æ˜¯é€šè¿‡<a href="https://d3js.org/" target="_blank" rel="noopener">d3</a>è¿™ä¸ªä¼Ÿå¤§çš„å¯è§†åŒ–åº“ã€‚</p>
<h4 id="æ’ä»¶æ ·ä¾‹"><a href="#æ’ä»¶æ ·ä¾‹" class="headerlink" title="æ’ä»¶æ ·ä¾‹"></a>æ’ä»¶æ ·ä¾‹</h4><p>ä»ä¼—å¤šä¼˜ç§€çš„visæ’ä»¶ä¸­é€‰æ‹©äº†ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„<a href="https://github.com/ommsolutions/kibana_ext_metrics_vis">æ ·ä¾‹</a>æ¥åšåˆ†æ(ä¸»è¦æ˜¯äººå®¶æœ‰å›¾)ã€‚æ•ˆæœå¦‚gifå›¾ï¼Œç”¨æ–‡å­—æ¥è¯´æ˜çš„è¯ï¼Œå°±æ˜¯å®ç°äº†ä¸€ä¸ªå¯è®¡ç®—çš„æ’ä»¶ï¼Œé€‰æ‹©metricå€¼ï¼Œç„¶åå¡«å…¥è®¡ç®—å…¬å¼ï¼Œå¾—å‡ºå€¼ã€‚(å› ä¸ºè§è¯†æœ‰é™ï¼Œä»¥å‰æ€»è¯´åœ¨kibanaä¸­å®ç°è®¡ç®—å¾ˆå¤æ‚ï¼Œç°åœ¨çœ‹æ¥çœŸæ˜¯å•ªå•ª(*10)æ‰“è„¸)ã€‚</p>
<p>extended_metric_vis.jså¾ˆæ˜æ˜¾ï¼Œæ˜¯è¿™ä¸ªæ’ä»¶çš„å¤§å¤´ã€‚ç¨å¾®ç²˜ä¸€ç‚¹ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">return new TemplateVisType(&#123;</span><br><span class="line">    name: &apos;extended_metric&apos;,</span><br><span class="line">    title: &apos;Extended Metric&apos;,</span><br><span class="line">    description: &apos;Based on the core Metric-Plugin but gives you the ability&apos; +</span><br><span class="line">      &apos;to output custom aggregates on metric-results.&apos;,</span><br><span class="line">    icon: &apos;fa-calculator&apos;,</span><br><span class="line">    template: extendedMetricVisTemplate, //è§†å›¾æ¨¡æ¿.html</span><br><span class="line">    params: &#123; //Optionsé€‰é¡¹ï¼Œé¢„å®šä¹‰çš„Optionsé€‰é¡¹åŠå€¼ï¼Œåœ¨å¯¹åº”è§†å›¾ä¸­ä¼šæœ‰å…·ä½“ä½¿ç”¨</span><br><span class="line">      defaults: &#123;</span><br><span class="line">        handleNoResults: true,</span><br><span class="line">        fontSize: 60,</span><br><span class="line">        outputs: [</span><br><span class="line">          &#123;</span><br><span class="line">            formula: &apos;metrics[0].value * metrics[0].value&apos;,</span><br><span class="line">            label: &apos;Count squared&apos;,</span><br><span class="line">            enabled: true</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      editor: metricVisParamsTemplate //Optionsé€‰é¡¹å¡è§†å›¾æ¨¡æ¿.html</span><br><span class="line">    &#125;,</span><br><span class="line">    schemas: new Schemas([ //Dataç›¸å…³ï¼Œè¿™é‡Œå°±ä¸æ˜¯è‡ªç”±å‘æŒ¥çš„åœ°ç•Œäº†ï¼Œå±äºåŠå‘½é¢˜ç±»å‹ï¼Œæ ¹æ®è‡ªå·±éœ€è¦çš„æ•°æ®é€‰æ‹©å¯¹åº”ç±»å‹ï¼ŒåŸºæœ¬</span><br><span class="line">    					//å°±æ˜¯metricï¼Œbucketçš„ç»„åˆï¼Œä¸€èˆ¬æ¥è¯´ï¼Œmetric æ•°å€¼èšåˆè‚¯å®šæ˜¯ Y è½´ï¼›bucket èšåˆè‚¯å®šæ˜¯ X è½´ï¼›</span><br><span class="line">      &#123;           //è€Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿˜å¯ä»¥è®© bucket æœ‰ä¸åŒæ•ˆæœï¼Œä¹Ÿå°±æ˜¯ Schema é‡Œçš„ segment(é»˜è®¤), group å’Œ splitã€‚</span><br><span class="line">        group: &apos;metrics&apos;,</span><br><span class="line">        name: &apos;metric&apos;,</span><br><span class="line">        title: &apos;Metric&apos;,</span><br><span class="line">        min: 1,</span><br><span class="line">        defaults: [</span><br><span class="line">          &#123; type: &apos;count&apos;, schema: &apos;metric&apos; &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç¨å¾®çœ‹äº†ä¸‹visæ’ä»¶çš„æ•™ç¨‹çš„è¯ï¼Œå°±ä¼šå¾ˆç†Ÿæ‚‰ï¼Œå› ä¸ºæ¨¡æ¿å°±å·®ä¸å¤šæ˜¯è¿™æ ·ï¼Œåˆ©ç”¨TemplateVisTypeç”Ÿæˆå¯¹åº”å®ä¾‹ï¼ŒåŸºæœ¬å¤‡æ³¨éƒ½åœ¨ä»£ç é‡Œäº†ï¼Œå°±ä¸å†å•°å—¦äº†ã€‚</p>
<p>ç„¶åæ ¹æ®ä¸Šé¢çš„ä»£ç ç›´æ¥çš„æ‰¾åˆ°ä¸¤ä¸ªhtmlï¼Œextended_metric_vis.htmlå’Œextended_metric_vis_params.html, å¾ˆæ˜¾ç¤ºï¼Œå°±æ˜¯view,ä¼šçœ‹åˆ°ä¼Ÿå¤§çš„angularè¿›è¡Œmvcçš„ç®¡ç†ï¼Œç„¶åå»çœ‹c =&gt; extended_metric_vis_controller.jsã€‚è¿™ä¸ªä»£ç é‡Œï¼Œä¸»è¦æ˜¯angularä¸å…¶æ§åˆ¶å™¨çš„ç»‘å®šï¼Œè·³è¿‡è¿™ä¸ªï¼Œè¿›åˆ°æ–¹æ³•é‡Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$scope.$watch(&apos;esResponse&apos;, function (resp) &#123;</span><br><span class="line">    if (resp) &#123;</span><br><span class="line">      calcOutputs.length = 0;</span><br><span class="line">      metrics.length = 0;</span><br><span class="line">      //æ¸…ç©ºmetrics</span><br><span class="line">      for (let key in metrics) &#123;</span><br><span class="line">        if (metrics.hasOwnProperty(key)) &#123;</span><br><span class="line">          delete metrics[key];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      $scope.processTableGroups(tabifyAggResponse($scope.vis, resp));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾ï¼Œè¿™é‡Œæ˜¯æ¥å—esæŸ¥è¯¢ç»“æœçš„ä»£ç ï¼Œç»“è®ºå¾ˆæ˜æ˜¾æ˜¯ï¼Œè·å¾—esæŸ¥è¯¢ç»“æœåªéœ€è¦ç›‘å¬esResponseå˜é‡å°±å¯ä»¥ã€‚ç„¶åçœ‹çœ‹æ‹¿åˆ°ç»“æœçš„å¤„ç†processTableGroupsæ–¹æ³•ã€‚é¦–å…ˆæ˜¯tabifyAggResponseæ˜¯æŒ‰ç…§å·²çŸ¥çš„esæŸ¥è¯¢ç»“æœç»“æ„ç”Ÿæˆä¸è§†å›¾(dataé€‰é¡¹å¡)å¼ºç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œä¸ºä»€ä¹ˆè¯´å¼ºç›¸å…³å‘¢ï¼Œæ¯”å¦‚tabifyAggResponseåçš„ç»“æœä¸»è¦åŒ…æ‹¬columnså’Œrowsï¼Œåˆ†åˆ«æ˜¯dataé€‰é¡¹å¡çš„åˆ†ç»„å’Œå¯¹åº”çš„æ•°æ®ï¼Œå°±æ‹¿è¿™ä¸ªä¾‹å­æ¥è¯´ï¼Œå¦‚æœæ–°å»ºäº†ä¸¤ä¸ªmetric, columnsé‡Œå°±æ˜¯è¿™ä¸¤ä¸ªmetricçš„å±æ€§ï¼ŒåŒ…å«title(å³è¾“å…¥çš„label)ç­‰ï¼Œå¯¹åº”indexçš„rowsé‡Œçš„æ•°æ®å°±æ˜¯å¯¹åº”metricçš„ç»“æœã€‚è½¬æ¢ä¹‹åï¼Œåœ¨processTableGroupsæ–¹æ³•é‡Œï¼Œåªéœ€è¦æŠŠå¯¹åº”çš„æ•°æ®æ‹¿å‡ºæ¥ç»„åˆä¸‹ï¼Œæ¯”å¦‚ï¼Œä¾‹å­é‡Œå°±æ˜¯ä»¥columnsä¸­çš„titleä¸ºé”®ï¼Œä»¥metricçš„ç»“æœä¸ºå€¼ï¼Œç»„æˆæ•°æ®åˆ°metrics(è£…æ•°æ®çš„å¯¹è±¡ï¼Œä¸‹æ–¹ä¼šç”¨åˆ°)ä¸­ã€‚</p>
<p>viewæœ‰äº†ï¼Œæ•°æ®ä¹Ÿæœ‰äº†ï¼Œè¿˜å·®æœ€åä¸€æ­¥ï¼Œå°±æ˜¯æ€ä¹ˆæŠŠå…¬å¼å¥—è¿›å»ï¼Ÿåœ¨è¿™é‡Œï¼Œæˆ‘ä¸å¾—ä¸å†æ¬¡æ„Ÿå¹ä¸‹jsçš„ä¼Ÿå¤§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">  const func = Function(&quot;metrics&quot;, &quot;return &quot; + output.formula); //&lt;&lt;&lt;&lt;=è¿™é‡Œæ˜¯äº®ç‚¹</span><br><span class="line">  output.value = func(metrics) || &quot;?&quot;;</span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line">  output.value = &apos;?&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>output.formulaä¸ºè¾“å…¥çš„å…¬å¼ï¼Œç±»å‹ä¸ºstringï¼Œç„¶åä¸€å¥stringçš„å­—ç¬¦ä¸²å°±å˜æˆæ–¹æ³•äº†ï¼Ÿï¼æ˜¯çš„ã€‚å¾ˆç¥å¥‡ã€‚æœ‰äº†æ–¹æ³•ï¼ŒæŠŠæ•°æ®å¥—è¿›å»ï¼Œç­”æ¡ˆå°±å‡ºæ¥äº†ã€‚</p>
<p>å¤§æ¦‚å†…å®¹å°±æ˜¯è¿™æ ·ï¼Œå¯èƒ½è¿˜æœ‰äº›ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œæ¯”å¦‚ï¼Œä¿®æ”¹äº†data/optionç‚¹å‡»é‚£ä¹ˆé‡ç»˜çš„æŒ‰é’®ï¼Œé‡æ–°è®¡ç®—ï¼Œéœ€è¦ç›‘å¬å¯¹åº”æ•°æ®ï¼Œå¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//updateOutputsä¸ºè®¡ç®—çš„è¿‡ç¨‹</span><br><span class="line">$scope.$watchCollection(&apos;vis.params.outputs&apos;, updateOutputs);</span><br></pre></td></tr></table></figure>

<h4 id="æºç æ ·ä¾‹"><a href="#æºç æ ·ä¾‹" class="headerlink" title="æºç æ ·ä¾‹"></a>æºç æ ·ä¾‹</h4><p>æ¥ä¸‹æ¥å°±çœ‹çœ‹ç¨å¾®è‚¤æµ…ç‚¹çš„æºç ï¼Œæ—¶é—´å’Œèƒ½åŠ›ç¡®å®æœ‰é™å•Šã€‚æ¯”å¦‚ä¸Šé¢å‡ºç°è¿‡çš„TemplateVisTypeï¼Œæ•´ä½“ç†è§£ä¸‹ç»“æ„å’Œè¿ä½œã€‚</p>
<ul>
<li><p>src/core_plugins/kbn_vislib_vis_types</p>
<p>è‡ªå¸¦çš„visç»„ä»¶å®šä¹‰çš„åœ°æ–¹ã€‚è¿˜åŒ…æ‹¬optionsé€‰é¡¹å¡çš„html,jsç­‰ç­‰ï¼Œçœ‹çœ‹line.jsçš„éƒ¨åˆ†ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">return new VislibVisType(&#123;</span><br><span class="line">  name: &apos;line&apos;,</span><br><span class="line">  title: &apos;Line&apos;,</span><br><span class="line">  image,</span><br><span class="line">  description: &apos;Emphasize trends&apos;,</span><br><span class="line">  category: VisType.CATEGORY.BASIC,</span><br><span class="line">  params: &#123;</span><br><span class="line">    defaults: &#123;</span><br><span class="line">      grid: &#123;</span><br><span class="line">        categoryLines: false,</span><br><span class="line">        style: &#123;</span><br><span class="line">          color: &apos;#eee&apos;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      ...</span><br><span class="line">    &#125;,</span><br><span class="line">    positions: [&apos;top&apos;, &apos;left&apos;, &apos;right&apos;, &apos;bottom&apos;],</span><br><span class="line">    ...</span><br><span class="line">    editor: pointSeriesTemplate,</span><br><span class="line">    ...</span><br><span class="line">    schemas: new Schemas([</span><br><span class="line">    &#123;</span><br><span class="line">      group: &apos;metrics&apos;,</span><br><span class="line">      name: &apos;metric&apos;,</span><br><span class="line">      title: &apos;Y-Axis&apos;,</span><br><span class="line">      min: 1,</span><br><span class="line">      aggFilter: [&apos;!geo_centroid&apos;],</span><br><span class="line">      defaults: [</span><br><span class="line">        &#123; schema: &apos;metric&apos;, type: &apos;count&apos; &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">   	....</span><br><span class="line">  ])</span><br></pre></td></tr></table></figure>

<p>å’Œä¸Šæ–¹extended_metric_vis.jsç²˜å‡ºæ¥çš„ä»£ç å¾ˆç›¸ä¼¼å§ï¼Œåªä¸è¿‡ä¸€ä¸ªæ˜¯ä½¿ç”¨çš„TemplateVisTypeï¼Œä¸€ä¸ªæ˜¯VislibVisTypeï¼Œå…¶å®è¿™ä¸¤ä¸ªç±»ä¹Ÿå¾ˆç›¸ä¼¼ï¼Œéƒ½æ˜¯ç»§æ‰¿vis_typeã€‚ä¸è¿‡ä»è¿™ç‚¹ä¸Šæ¥çœ‹ï¼Œå®šä¹‰visç»„ä»¶çš„å¥—è·¯å…¶å®å·®ä¸å¤šï¼ŒåŒºåˆ«å‘¢ï¼Œå°±æ˜¯å®˜æ–¹çš„ç»„ä»¶çš„è¯è§†å›¾ç»˜åˆ¶çš„éƒ¨åˆ†åº”è¯¥æ˜¯å†…å®šçš„ï¼Œç›´æ¥é€‰æ‹©å‡ºæ¥ç»˜åˆ¶å°±å¥½äº†(åœ¨åé¢ä¼šçœ‹åˆ°é€‰æ‹©çš„ä»£ç )ï¼Œä½†æ˜¯è‡ªå®šä¹‰visç»„ä»¶çš„è¯ï¼Œè§†å›¾éƒ¨åˆ†æ˜¯éœ€è¦è‡ªå·±è‡ªå®šä¹‰çš„ï¼Œè€Œä¸æ˜¯é€‰æ‹©åŸæœ‰çš„ï¼Œæ‰€ä»¥è‡ªå®šä¹‰éœ€è¦TemplateVisTypeå¯¹è±¡ï¼Œä¼ å…¥templateè§†å›¾ã€‚</p>
</li>
<li><p>src/public/ui/vis/vis_type</p>
<p>å®šä¹‰åŸºæœ¬å±æ€§å’Œæ–¹æ³•createRenderbotã€‚ç»§æ‰¿è¿™ä¸ªçš„è¯éœ€è¦å®ç°createRenderbotæ–¹æ³•è¿”å›Renderbotå¯¹è±¡ã€‚</p>
</li>
<li><p>src/public/ui/vislib_vis_type/vislib_vis_type</p>
<p>ç»§æ‰¿vis_typeã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">const updateParams = function (params) &#123;</span><br><span class="line">	const updateIfSet = (from, to, prop, func) =&gt; &#123;</span><br><span class="line">      if (from[prop]) &#123;</span><br><span class="line">        to[prop] = func ? func(from[prop]) : from[prop];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br><span class="line">...</span><br><span class="line">// Â·ã€‚ç¬¬ä¸€ï¼Œç»§æ‰¿VisTypeï¼Œçœ‹åˆ°responseConverteré»˜è®¤æ˜¯è½¬æ¢ä¸ºç‚¹çº¿å›¾æ•°ç»„çš„ã€‚</span><br><span class="line">_.class(VislibVisType).inherits(VisType);</span><br><span class="line">  function VislibVisType(opts = &#123;&#125;) &#123;</span><br><span class="line">    VislibVisType.Super.call(this, opts);</span><br><span class="line"></span><br><span class="line">    if (this.responseConverter == null) &#123;</span><br><span class="line">      this.responseConverter = pointSeries;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    this.listeners = opts.listeners || &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">// Â·ã€‚ç¬¬äºŒï¼Œå®ç°createRenderbot</span><br><span class="line">   VislibVisType.prototype.createRenderbot = function (vis, $el, uiState) &#123;</span><br><span class="line">   // åœ¨è¿”å›æ–°VislibRenderbotå¯¹è±¡ä¹‹å‰ï¼Œå¯¹vis.paramsè¿›è¡Œäº†ç›¸åº”çš„è½¬æ¢å’Œåˆ¤æ–­ï¼Œæ¯”å¦‚æŠŠä¸€äº›paramsä¸‹çš„å±æ€§å¯¹åº”ç§»åˆ°params.seriesParams[0]æˆ–è€…params.valueAxes[0]ï¼Œparams.categoryAxes[0]ä¸‹</span><br><span class="line">    updateParams(vis.params);</span><br><span class="line">    return new VislibRenderbot(vis, $el, uiState);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°åŸºæœ¬å°±æ˜¯paramsçš„è½¬æ¢ï¼Œå’Œè¿”å›VislibRenderbotä½œä¸ºRenderbotå¯¹è±¡ï¼Œé‚£ä¹ˆï¼Œä¹…é—»çš„Renderbotçš„ä½œç”¨ï¼Ÿé¢„çŸ¥åäº‹å¦‚ä½•ï¼Œè¯·çœ‹åé¢..</p>
</li>
<li><p>src/public/ui/vislib_vis_type/vislib_renderbot</p>
<p>æ©ï¼ŒRenderbotä¸­å®šä¹‰äº†éœ€å®ç°çš„ä¸€äº›æ–¹æ³•ï¼ŒVislibRenderbotå°±ç»§æ‰¿Renderbotï¼Œæ•…å°±ç›´æ¥çœ‹VislibRenderbotçš„ä»£ç äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VislibRenderbot.prototype.render = function (esResponse) &#123;</span><br><span class="line">  this.chartData = this.buildChartData(esResponse);</span><br><span class="line">  return AngularPromise.delay(1).then(() =&gt; &#123;</span><br><span class="line">    this.vislibVis.render(this.chartData, this.uiState); //ç»˜åˆ¶</span><br><span class="line">    this.refreshLegend++;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚renderæ–¹æ³•,é€šè¿‡è°ƒç”¨vislibRenderbot.renderæ–¹æ³•å®ç°ç»˜åˆ¶ã€‚<br>çœ‹åˆ°è¿™é‡Œï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰çœ‹åˆ°åŠ äº†æ³¨é‡Šé‚£å¥ä»£ç ï¼Œç»˜åˆ¶çš„ä¸»è¦å·¥ä½œåº”è¯¥å°±åœ¨è¿™è¡Œä»£ç ï¼Œé‚£ä¹ˆå¥½å¥‡ä¸€ä¸‹this.vislibVisåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ‰¾åˆ°this.vislibVisçš„åˆå§‹åŒ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.vislibVis = new vislib.Vis(this.$el[0], this.vislibParams);</span><br></pre></td></tr></table></figure>

<p>åœ¨Visä¸­ï¼Œä¸»è¦æ˜¯visConfigå’Œhandler, handlerç»˜åˆ¶ï¼ŒvisConfigé€‰æ‹©ç”Ÿæˆç›¸åº”çš„æ•°æ®ç»“æ„ã€‚å¯¹äºvisConfigçš„ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//src/public/ui/vislib/vis_config.js</span><br><span class="line">const visType = visTypes[visConfigArgs.type];</span><br><span class="line">const typeDefaults = visType(visConfigArgs, this.data); // &lt;= æ•°æ®ç»“æ„æ›´æ”¹</span><br><span class="line"></span><br><span class="line">//visTypes =&gt; src/public/ui/vislib/types</span><br><span class="line">  return &#123;</span><br><span class="line">    histogram: pointSeries.column,</span><br><span class="line">    horizontal_bar: pointSeries.column,</span><br><span class="line">    line: pointSeries.line,</span><br><span class="line">    pie: Private(VislibLibTypesPieProvider),</span><br><span class="line">    area: pointSeries.area,</span><br><span class="line">    point_series: pointSeries.line,</span><br><span class="line">    heatmap: pointSeries.heatmap,</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>

<p>handlerç»˜åˆ¶,handlerçš„renderæ–¹æ³•ä¸­,å¯ä»¥çœ‹åˆ°chart.render</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// render in handler</span><br><span class="line">render() &#123;</span><br><span class="line">	...</span><br><span class="line">	const chart = new self.ChartClass(self, this, chartData);</span><br><span class="line">	...</span><br><span class="line">	chart.render();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ChartClass in handler</span><br><span class="line">this.ChartClass = chartTypes[visConfig.get(&apos;type&apos;)];</span><br><span class="line"></span><br><span class="line">//chartTypes from src/public/ui/vislib/visualizations/vis_types</span><br><span class="line">//è¿™é‡Œé¢æ˜¯è¿›è¡Œå¯è§†åŒ–çš„åœ°æ–¹ï¼Œå¯è§†åŒ–å¯¹è±¡éƒ½ç»§æ‰¿è‡ªChartç±»ï¼Œcomponents/vislib/visualizations/_chart</span><br><span class="line">  Chart.prototype.render = function () &#123;</span><br><span class="line">      var selection = d3.select(this.chartEl);</span><br><span class="line">      selection.selectAll(&apos;*&apos;).remove();</span><br><span class="line">      selection.call(this.draw());</span><br><span class="line">   &#125;;</span><br><span class="line">  //ä¹Ÿå°±æ˜¯è¯´ï¼Œå„ä¸ªå¯è§†åŒ–å¯¹è±¡ï¼Œåªéœ€è¦ç”¨ d3.js æˆ–è€…å…¶ä»–ç»˜å›¾åº“ï¼Œå®Œæˆè‡ªå·±çš„ draw() å‡½æ•°ï¼Œå°±å¯ä»¥äº†ï¼å¯ä»¥åœ¨æœ¬æ–‡ä»¶å¤¹ä¸‹æŸ¥çœ‹å…·ä½“ä¸€äº›ç»˜åˆ¶ä»£ç </span><br></pre></td></tr></table></figure>
</li>
<li><p>src/public/visualize/visualize</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$scope.$watch(&apos;esResp&apos;, prereq(function (resp) &#123;</span><br><span class="line">    if (!resp) return;</span><br><span class="line">    $scope.renderbot.render(resp);</span><br><span class="line">  &#125;));</span><br></pre></td></tr></table></figure>

<p> å¾ˆæ˜æ˜¾ï¼Œvisualize.jsæ˜¯Visualizationçš„å¤§Bossï¼Œé€šè¿‡ä»£ç å¯ä»¥çœ‹å‡ºï¼Œvisualizeä¸vis_typesäº¤äº’ä¸»è¦é€šè¿‡è°ƒç”¨renderbotçš„å„ç§æ–¹æ³•ï¼ŒåŒ…æ‹¬renderã€‚</p>
</li>
</ul>
<p>å¤§è‡´æ€»ç»“ä¸€ä¸‹ï¼Œè¦å®šä¹‰visç»„ä»¶çš„è¯ï¼Œè¿”å›VislibVisTypeæˆ–TemplateVisTypeå¯¹è±¡ï¼Œè¿™ä¸¤ä¸ªç±»å†…éƒ¨éƒ½ä¼šç”Ÿæˆå¯¹åº”çš„renderbotå¯¹è±¡ï¼Œvisualizeä¸é€šè¿‡è°ƒç”¨renderbotå¯¹è±¡è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œï¼Œå¦‚æœæ˜¯è‡ªå®šä¹‰ç»„ä»¶çš„è¯ï¼Œè¿”å›çš„TemplateVisTypeå¯¹è±¡éœ€è¦å…·æœ‰templateå±æ€§ï¼Œä¸ºå›¾è¡¨è§†å›¾æ¨¡æ¿(html), å®˜æ–¹è‡ªå¸¦çš„ç»„ä»¶çš„è¯ï¼Œä¼šæ ¹æ®ç±»å‹è¿›è¡Œé€‰æ‹©è§†å›¾ã€‚å¯¹äºè§†å›¾çš„ç»˜åˆ¶(åŒ…æ‹¬ä¿®æ”¹é€‰é¡¹å¡ï¼Œé‡ç»˜)ï¼Œvisualizeä¼šè°ƒç”¨renderbot.renderæ–¹æ³•ï¼ŒVisRenderbotçš„renderæ–¹æ³•å³é‡ç»˜..åœ¨ä¸Šæ–¹ç²˜è´´çš„ä»£ç ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒTemplateRenderbotçš„renderæ–¹æ³•æ˜¯å°†esResponseæ•°æ®ç»‘å®šåˆ°å½“å‰ä½œç”¨åŸŸçš„esResponseå˜é‡ä¸Šï¼Œæ‰€ä»¥è‡ªå®šä¹‰æ’ä»¶ä¸­è¦å®Œæˆç»˜åˆ¶çš„è¯ï¼Œéœ€è¦ç›‘å¬å½“å‰ä½œç”¨åŸŸçš„esResponseå˜é‡ã€‚</p>
<p>å¥½å•¦ï¼Œå®˜æ–¹è‡ªå¸¦çš„ç»„ä»¶çš„ä»£ç ä»‹ç»å’Œè‡ªå¼€å‘æ’ä»¶çš„ä»£ç ä»‹ç»å°±åˆ°è¿™é‡Œå°±ç»“æŸå•¦ã€‚</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/categories/">Categories</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’"><span class="toc-number">1.</span> <span class="toc-text">Kibanaæ’ä»¶ç¬¬ä¸€è§†è§’</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰"><span class="toc-number">1.1.</span> <span class="toc-text">Kibanaæ’ä»¶å¤§æ¦‚ç±»å‹æœ‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¦–è¦ç›®æ ‡æ˜¯visTypes"><span class="toc-number">1.1.1.</span> <span class="toc-text">é¦–è¦ç›®æ ‡æ˜¯visTypes</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…¨å†›å‡ºå‡»"><span class="toc-number">1.2.</span> <span class="toc-text">å…¨å†›å‡ºå‡»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#First-Blood"><span class="toc-number">1.3.</span> <span class="toc-text">First Blood</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ç¤ºä¾‹extended-metric"><span class="toc-number">1.3.1.</span> <span class="toc-text">ç¤ºä¾‹extended_metric</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç¤ºä¾‹line-sg"><span class="toc-number">1.3.2.</span> <span class="toc-text">ç¤ºä¾‹line_sg</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#visTypes"><span class="toc-number">1.4.</span> <span class="toc-text">visTypes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ’ä»¶æ ·ä¾‹"><span class="toc-number">1.4.1.</span> <span class="toc-text">æ’ä»¶æ ·ä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æºç æ ·ä¾‹"><span class="toc-number">1.4.2.</span> <span class="toc-text">æºç æ ·ä¾‹</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&text=kibana-plugin"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&is_video=false&description=kibana-plugin"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=kibana-plugin&body=Check out this article: https://github.com/xiaoxuez/2017/10/14/kibana-plugin/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&title=kibana-plugin"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://github.com/xiaoxuez/2017/10/14/kibana-plugin/&name=kibana-plugin&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 zoie
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/categories/">Categories</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
